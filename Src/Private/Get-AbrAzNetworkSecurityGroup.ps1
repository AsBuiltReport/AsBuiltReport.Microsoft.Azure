function Get-AbrAzNetworkSecurityGroup {
    <#
    .SYNOPSIS
        Used by As Built Report to retrieve Azure Network Security Group information
    .DESCRIPTION

    .NOTES
        Version:        0.1.2
        Author:         Tim Carman
        Twitter:        @tpcarman
        Github:         tpcarman
    .EXAMPLE

    .LINK

    #>
    [CmdletBinding()]
    param (
    )

    begin {
        Write-PScriboMessage "NetworkSecurityGroup InfoLevel set at $($InfoLevel.NetworkSecurityGroup)."
    }

    process {
        Try {
            if ($InfoLevel.NetworkSecurityGroup -gt 0) {
                $AzNetworkSecurityGroups = Get-AzNetworkSecurityGroup | Sort-Object Name
                if ($AzNetworkSecurityGroups) {
                    Write-PscriboMessage "Collecting Azure Network Security Group information."
                    Section -Style Heading4 'Network Security Groups' {
                        if ($Options.ShowSectionInfo) {
                            Paragraph "An Azure Network Security Group (NSG) is used to filter network traffic to and from Azure resources in an Azure virtual network. A network security group contains security rules that allow or deny inbound network traffic to, or outbound network traffic from, several types of Azure resources. For each rule, you can specify source and destination, port, and protocol."
                            BlankLine
                            Try {
                                Image -Text 'Network Security Group' -Align 'Center' -Percent 100 -Base64 "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"
                                BlankLine
                            } Catch {
                                Write-PScriboMessage -IsWarning "Unable to display Network Security Group image."
                            }
                        }
                        $AzNsgInfo = @()
                        foreach ($AzNetworkSecurityGroup in $AzNetworkSecurityGroups) {
                            $NsgSecurityRules = @()
                            $NsgSecurityRules += $AzNetworkSecurityGroup.SecurityRules
                            $NsgSecurityRules += $AzNetworkSecurityGroup.DefaultSecurityRules

                            $InObj = [Ordered]@{
                                'Name' = $AzNetworkSecurityGroup.Name
                                'Resource Group' = $AzNetworkSecurityGroup.ResourceGroupName
                                'Location' = $AzLocationLookup."$($AzNetworkSecurityGroup.Location)"
                                'Subscription' = "$($AzSubscriptionLookup.(($AzNetworkSecurityGroup.Id).split('/')[2]))"
                                'Associated With' = "$(($AzNetworkSecurityGroup.Subnets.Id).Count) subnets, $(($AzNetworkSecurityGroup.NetworkInterfaces.Id).Count) NICs"
                                'Network Interfaces' = if ($AzNetworkSecurityGroup.NetworkInterfaces.Id) {
                                    ($AzNetworkSecurityGroup.NetworkInterfaces.Id | ForEach-Object {$_.split('/')[-1]}) -join ', '
                                } else {
                                    'None'
                                }
                                'Subnets' = if ($AzNetworkSecurityGroup.Subnets.Id) {
                                    ($AzNetworkSecurityGroup.Subnets.Id | ForEach-Object {$_.split('/')[-1]}) -join ', '
                                } else {
                                    'None'
                                }
                            }

                            if ($Options.ShowTags) {
                                $InObj['Tags'] = if ([string]::IsNullOrEmpty($AzNetworkSecurityGroup.Tag)) {
                                    'None'
                                } else {
                                    ($AzNetworkSecurityGroup.Tag.GetEnumerator() | ForEach-Object { "$($_.Name):`t$($_.Value)" }) -join [Environment]::NewLine
                                }
                            }

                            $AzNsgInfo += [PSCustomObject]$InObj
                        }

                        if ($InfoLevel.NetworkSecurityGroup -ge 2) {
                            Paragraph "The following sections detail the configuration of the network security groups within the $($AzSubscription.Name) subscription."
                            foreach ($AzNetworkSecurityGroup in $AzNsgInfo) {
                                Section -Style NOTOCHeading5 -ExcludeFromTOC "$($AzNetworkSecurityGroup.Name)" {
                                    $TableParams = @{
                                        Name = "Network Security Group - $($AzNetworkSecurityGroup.Name)"
                                        List = $true
                                        ColumnWidths = 40, 60
                                    }
                                    if ($Report.ShowTableCaptions) {
                                        $TableParams['Caption'] = "- $($TableParams.Name)"
                                    }
                                    $AzNetworkSecurityGroup | Table @TableParams

                                    Get-AbrAzNetworkSecurityGroupRule -Name $($AzNetworkSecurityGroup.Name)
                                }
                            }
                        } else {
                            Paragraph "The following table summarises the configuration of the network security groups within the $($AzSubscription.Name) subscription."
                            BlankLine
                            $TableParams = @{
                                Name = "Network Security Groups - $($AzSubscription.Name)"
                                List = $false
                                Columns = 'Name', 'Resource Group', 'Location', 'Associated With'
                                ColumnWidths = 25, 25, 25, 25
                            }
                            if ($Report.ShowTableCaptions) {
                                $TableParams['Caption'] = "- $($TableParams.Name)"
                            }
                            $AzNsgInfo | Table @TableParams
                        }
                    }
                }
            }
        } Catch {
            Write-PScriboMessage -IsWarning $($_.Exception.Message)
        }
    }

    end {}
}